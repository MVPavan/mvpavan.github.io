<!doctype html>




<html
    dir="ltr"
    lang="en"
    
>
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#ffffff">
    <link rel="stylesheet" href="/assets/css/app.css">
    <link
        rel="shortcut icon"
        type="image/png"
        
            href="/favicon.png"
        
    >
    <script defer src="https://unpkg.com/alpinejs@3.9.0/dist/cdn.min.js"></script>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">
    
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma-social@1/bin/bulma-social.min.css">
    
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>MVPavanâ€™s Notes | Welcome to my GitHub Pages site.</title>
<meta name="generator" content="Jekyll v3.9.5" />
<meta property="og:title" content="MVPavanâ€™s Notes" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Welcome to my GitHub Pages site." />
<meta property="og:description" content="Welcome to my GitHub Pages site." />
<link rel="canonical" href="http://localhost:4000/MVPArchive/AI/Modular/Mojo/benchmarks/MatMul/" />
<meta property="og:url" content="http://localhost:4000/MVPArchive/AI/Modular/Mojo/benchmarks/MatMul/" />
<meta property="og:site_name" content="MVPavanâ€™s Notes" />
<meta property="og:type" content="website" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="MVPavanâ€™s Notes" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"WebPage","description":"Welcome to my GitHub Pages site.","headline":"MVPavanâ€™s Notes","url":"http://localhost:4000/MVPArchive/AI/Modular/Mojo/benchmarks/MatMul/"}</script>
<!-- End Jekyll SEO tag -->

    <!-- head scripts -->
</head>

    <body>
        
            <div class="">
    <script
        src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.5/dist/js.cookie.min.js"
    ></script>

    <div class="container py-6 px-4" id="cookieBanner">
        <div class="columns">
            <div class="column is-fullwidth ">
                <div class="content">
                    <p>We use cookies on this site to enhance your user experience</p>
                    <p>
                        By clicking the Accept button, you agree to us doing so.
                        <a href="/cookie-policy/">More info on our cookie policy</a>
                    </p>
                </div>

                <div class="buttons">
                    <button class="button is-primary" onclick="acceptCookies()">Accept all cookies</button>
                    <button class="button is-primary" onclick="rejectCookies()">Reject all cookies</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        function acceptCookies() {
            
            Cookies.set('showCookieBanner', 'false', { expires: 7, path: '/' });
            Cookies.set('cookiesAccepted', 'true', {expires: 7, path: '/'});
            toggleCookieBanner();
        }

        function rejectCookies() {
            Cookies.set('showCookieBanner', 'false', { expires: 7, path: '/' });
            toggleCookieBanner();
        }

        function toggleCookieBanner() {
            var showBanner = Cookies.get('showCookieBanner');
            var banner = document.getElementById('cookieBanner');

            if (showBanner === 'false') {
                banner.setAttribute('style', 'display: none;');
            } else {
                banner.setAttribute('style', 'display: block;');
            }
        }

        toggleCookieBanner();
    </script>
</div>

        
        <nav
    class="navbar is-primary "
    x-data="{ openNav: false }"
>
    <div class="container">
        <div class="navbar-brand">
            <a href="/" class="navbar-item">
                MVPavan's Notes
            </a>
            <a
                role="button"
                class="navbar-burger burger"
                aria-label="menu"
                aria-expanded="false"
                data-target="navMenu"
                :class="{ 'is-active': openNav }"
                x-on:click="openNav = !openNav"
            >
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
                <span aria-hidden="true"></span>
            </a>
        </div>
        <div class="navbar-menu" id="navMenu" :class="{ 'is-active': openNav }">
            <div class="navbar-start">
                <a href="/" class="navbar-item ">Home</a>
                
                    
                        
                            <a
                                href="/docs/"
                                class="navbar-item "
                            >Docs</a>
                        
                    
                
            </div>

            <div class="navbar-end">
                
            </div>
        </div>
    </div>
</nav>

        
            <section
    class="hero  is-medium  is-bold is-primary"
    
>
    <div class="hero-body ">
        <div class="container">
            <h1 class="title is-2"></h1>
            <p class="subtitle is-3"></p>
            
        </div>
    </div>
</section>

        
        

        <section class="section">
            <div class="container">
                <div class="columns is-multiline">
                    
                    <div class="column is-8">
                        

                        

                        

                        

                        
<div class="content">
    <pre><code class="language-table-of-contents">title: 
style: nestedList # TOC style (nestedList|nestedOrderedList|inlineFirstLevel)
minLevel: 0 # Include headings from the specified level
maxLevel: 0 # Include headings up to the specified level
includeLinks: true # Make headings clickable
debugInConsole: false # Print debug info in Obsidian console
</code></pre>
<h2 id="cpu">CPU</h2>

<ul>
  <li>Physical cores: 20</li>
  <li>Physical + Logical cores: 40
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Architecture:                    x86_64
CPU op-mode(s):                  32-bit, 64-bit
Byte Order:                      Little Endian
Address sizes:                   46 bits physical, 48 bits virtual
CPU(s):                          40
On-line CPU(s) list:             0-39
Thread(s) per core:              2
Core(s) per socket:              10
Socket(s):                       2
NUMA node(s):                    2
Vendor ID:                       GenuineIntel
CPU family:                      6
Model:                           85
Model name:                      Intel(R) Xeon(R) Silver 4210R CPU @ 2.40GHz
Stepping:                        7
CPU MHz:                         2400.000
CPU max MHz:                     3200.0000
CPU min MHz:                     1000.0000
</code></pre></div>    </div>
  </li>
</ul>

<blockquote>
  <p>Mojo is using only physical cores where as numpy utilizing all 40 cores</p>
</blockquote>

<h2 id="matmul-benchmark-results">MatMul Benchmark Results</h2>

<table>
  <thead>
    <tr>
      <th>Metric</th>
      <th>512x256 @ 256x512</th>
      <th>Speed over Python</th>
      <th>Speedup over NumPy</th>
      <th>2048x1024 @ 1024x2048</th>
      <th>Speedup over NumPy</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Python (Lists)</td>
      <td>77</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>NumPy</td>
      <td>0.0010</td>
      <td>74844.5881</td>
      <td>N/A</td>
      <td>0.0195</td>
      <td>N/A</td>
    </tr>
    <tr>
      <td>Mojo (For Loops)</td>
      <td>0.6402</td>
      <td>120.2806</td>
      <td>0.0016</td>
      <td>40.9093</td>
      <td>0.0005</td>
    </tr>
    <tr>
      <td>Mojo (SIMD)</td>
      <td>0.0123</td>
      <td>6243.6854</td>
      <td>0.0834</td>
      <td>1.0428</td>
      <td>0.0187</td>
    </tr>
    <tr>
      <td>Mojo (SIMD + Parallel)</td>
      <td>0.0017</td>
      <td>46433.6542</td>
      <td>0.6204</td>
      <td>0.1260</td>
      <td>0.1547</td>
    </tr>
    <tr>
      <td>Mojo (SIMD+ Parallel+ DTypePointer)</td>
      <td>0.0006</td>
      <td>121557.0351</td>
      <td>1.6241</td>
      <td>0.0547</td>
      <td>0.3566</td>
    </tr>
  </tbody>
</table>

<h2 id="python-using-lists-">Python (Using Lists) ðŸ˜€</h2>
<ul>
  <li><code class="language-plaintext highlighter-rouge">512x256 @ 256x512</code>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Matmul : 512x256 @ 256x512
Iterations :  2
Total GFLOPS :  0.134217728
Total time in sec :  77.04722635447979
GFLOP/sec :  0.001742018945399663
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">2048x1024 @ 1024x2048</code> - My system got tired!</li>
</ul>

<blockquote>
  <p>All the operations from here are in FP32</p>
  <h2 id="numpy">Numpy</h2>
</blockquote>

<ul>
  <li><code class="language-plaintext highlighter-rouge">512x256 @ 256x512</code>
    <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Matmul : 512x256 @ 256x512
Iterations : 10000
Total GFLOPS :  0.134217728
Total time in sec :  0.0010287985601928084
GFLOP/sec :  130.46064914286632
speedup over python: 74890
</code></pre></div>    </div>
  </li>
  <li><code class="language-plaintext highlighter-rouge">2048x1024 @ 1024x2048</code>
```
Matmul : 2048x1024 @ 1024x2048
Iterations : 10000
Total GFLOPS :  8.589934592
Total time in sec :  0.019497849141806363
GFLOP/sec :  440.55805999554434</li>
</ul>

<p>Matmul : 2048x1024 @ 1024x2048
Iterations :  200
Total GFLOPS :  8.589934592
Total time in sec :  0.018091672335285695
GFLOP/sec :  474.80047354419173</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

## Mojo

### Just for loops

- `512x256 @ 256x512`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.64016959076470581
Total: 10.882883043
Iters: 17
Warmup Mean: 0.69197315560000006
Warmup Total: 3.4598657780000002
Warmup Iters: 5
Fastest Mean: 0.64016959076470592
Slowest Mean: 0.64016959076470592</p>

<p>Matmul :  512x256 @ 256x512
Total GFLOPS:  0.13421772800000001
GFLOP/sec:  0.20965964321996622
speedup over python:  120.35439899987139
speedup over numpy:  0.0016070718994381961
speedup in numpy:  622.24969545518297
worst speedup in numpy:  622.24969545518309</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- `2048x1024 @ 1024x2048`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 40.9093318165
Total: 245.455990899
Iters: 6
Warmup Mean: 40.8972278066
Warmup Total: 204.486139033
Warmup Iters: 5
Fastest Mean: 40.9093318165
Slowest Mean: 40.9093318165</p>

<p>Matmul :  2048x1024 @ 1024x2048</p>

<p>GFLOP/sec:  0.2099749424050826
speedup over python:  0.0
speedup over numpy:  0.00047661128344174706
speedup in numpy:  2098.1458785002164
worst speedup in numpy:  2098.1458785002164</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>


### SIMD Vectorization

- `512x256 @ 256x512`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.012332463752118645
Total: 11.641845782000001
Iters: 944
Warmup Mean: 0.0146965052
Warmup Total: 0.073482526000000006
Warmup Iters: 5
Fastest Mean: 0.012332463752118644
Slowest Mean: 0.012332463752118644</p>

<p>Matmul :  512x256 @ 256x512
Total GFLOPS:  0.13421772800000001
GFLOP/sec:  10.883285829803651
speedup over python:  6247.5128979190004
speedup over numpy:  0.083421981274104037
speedup in numpy:  11.987248261513317
worst speedup in numpy:  11.987248261513315</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- `2048x1024 @ 1024x2048`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 1.04279860254
Total: 52.139930127
Iters: 50
Warmup Mean: 1.1388049650000001
Warmup Total: 5.6940248249999996
Warmup Iters: 5
Fastest Mean: 1.04279860254
Slowest Mean: 1.04279860254</p>

<p>Matmul :  2048x1024 @ 1024x2048
Total GFLOPS:  8.5899345920000005
GFLOP/sec:  8.2373859833308565
speedup over python:  0.0
speedup over numpy:  0.018697617252568632
speedup in numpy:  53.482750582169636
worst speedup in numpy:  53.482750582169636</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

### SIMD Vectorization and Parallelization

- `512x256 @ 256x512`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.0016582828104565537
Total: 11.259740282999999
Iters: 6790
Warmup Mean: 0.0045278230000000003
Warmup Total: 0.022639115000000001
Warmup Iters: 5
Fastest Mean: 0.0016582828104565537
Slowest Mean: 0.0016582828104565537</p>

<p>Matmul :  512x256 @ 256x512
Total GFLOPS:  0.13421772800000001
GFLOP/sec:  80.937779221776751
speedup over python:  46462.054523297731
speedup over numpy:  0.62039994246190278
speedup in numpy:  1.6118634634809101
worst speedup in numpy:  1.6118634634809101</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- `2048x1024 @ 1024x2048`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.12600896040860216
Total: 11.718833318
Iters: 93
Warmup Mean: 0.1245288464
Warmup Total: 0.62264423199999996
Warmup Iters: 5
Fastest Mean: 0.12600896040860216
Slowest Mean: 0.12600896040860216</p>

<p>Matmul :  2048x1024 @ 1024x2048
Total GFLOPS:  8.5899345920000005
GFLOP/sec:  68.169236252294311
speedup over python:  0.0
speedup over numpy:  0.15473383066237342
speedup in numpy:  6.4627108093897254
worst speedup in numpy:  6.4627108093897254</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>

### SIMD Vectorize, Parallel using DTypePointer
Earlier used Tensor

- `512x256 @ 256x512`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.00063344754129086812
Total: 13.484831259
Iters: 21288
Warmup Mean: 0.0057730554000000002
Warmup Total: 0.028865277000000002
Warmup Iters: 5
Fastest Mean: 0.00063344754129086812
Slowest Mean: 0.00063344754129086812</p>

<p>Matmul :  512x256 @ 256x512
Total GFLOPS:  0.13421772800000001
GFLOP/sec:  211.8845196343884
speedup over python:  121631.58167362913
speedup over numpy:  1.6241259033009681
speedup in numpy:  0.61571581240564033
worst speedup in numpy:  0.61571581240564033</p>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- `2048x1024 @ 1024x2048`
</code></pre></div></div>
<hr />
<p>Benchmark Report (s)
â€”â€”â€”â€”â€”â€”â€”
Mean: 0.054670777668181819
Total: 12.027571087
Iters: 220
Warmup Mean: 0.057961355399999998
Warmup Total: 0.28980677700000002
Warmup Iters: 5
Fastest Mean: 0.054670777668181819
Slowest Mean: 0.054670777668181819</p>

<p>Matmul :  2048x1024 @ 1024x2048
Total GFLOPS:  8.5899345920000005
GFLOP/sec:  157.12113414840465
speedup over python:  0.0
speedup over numpy:  0.35664115224675202
speedup in numpy:  2.8039388996481325
worst speedup in numpy:  2.8039388996481325
```</p>

</div>

                    </div>
                    
                        <div class="column is-4-desktop is-4-tablet">
                            <p class="title is-4">Latest Posts</p>

<div class="columns is-multiline">
    
</div>

                        </div>
                    
                </div>
            </div>
        </section>
        
            <footer class="footer">
    <div class="container">
        
            <div class="columns is-multiline">
                
            </div>
        

        <div class="content is-small has-text-centered">
            <p class="">Theme built by <a href="https://www.csrhymes.com">C.S. Rhymes</a></p>
        </div>
    </div>
</footer>

        
        <script src="/assets/js/app.js" type="text/javascript"></script><!-- footer scripts -->
</body>
</html>
